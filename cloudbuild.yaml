steps:

- id: "Rodando docker-composer"
  name: 'gcr.io/$PROJECT_ID/docker-compose:1.25.5'
  args: ['-f','docker-compose.cloudbuild.yaml', 'up', '-d']

- id: "Rodando docker ps"
  name: 'gcr.io/cloud-builders/docker'
  args: ['ps']

- id: "Rodando npm install"
  name: 'gcr.io/cloud-builders/docker'
  args: ['exec','-t','micro-api-app','npm','install']

- id: "Rodando migrations"
  name: 'gcr.io/cloud-builders/docker'
  args: ['exec','-t','micro-api-app','yarn','typeorm migration:run']

- id: "Rodando tests"
  name: 'gcr.io/cloud-builders/docker'
  args: ['exec','-t','micro-api-app','yarn','test']    

